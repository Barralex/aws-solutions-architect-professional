# 3.10 AWS Resource Access Manager (RAM)

## Resumen
AWS RAM permite compartir recursos AWS que poseés con otras cuentas AWS, ya sea de cualquier cuenta o solo dentro de tu organización. El caso de uso más importante para el examen es compartir subnets VPC.

---

## Conceptos Clave

### 1. ¿Qué es RAM?

**Permite compartir recursos AWS con otras cuentas:**
- Desde cualquier cuenta AWS
- O solo desde cuentas dentro de tu organización
- Evita duplicar recursos

### 2. Qué se puede compartir (para el examen)

**Lo más importante - VPC Subnets:**
- Permite que recursos de diferentes cuentas estén en las mismas subnets
- Deben ser de la misma AWS Organization
- **NO se pueden compartir:** Security Groups ni VPC default

**Otros recursos compartibles:**
- Transit Gateway
- Route 53 Resolver rules y DNS Firewall rules
- License Manager configurations
- Aurora DB Cluster
- ACM Private Certificate Authority
- CodeBuild projects
- EC2 Dedicated Hosts y Capacity Reservations
- Glue Catalog, Database y Table
- Network Firewall Policies
- Resource Groups
- Systems Manager, Incidents
- Outposts

### 3. Compartir VPC Subnets (caso más importante)

```
╔═══════════════════════════════════════════════════════════════╗
║                    VPC COMPARTIDA                             ║
╠═══════════════════════════════════════════════════════════════╣
║                                                               ║
║  VPC Owner (dueño de la VPC)                                 ║
║  ┌─────────────────────────────────────────────────────────┐ ║
║  │                    Private Subnet                        │ ║
║  │                                                          │ ║
║  │  ┌──────────┐  ┌──────────┐  ┌──────────┐              │ ║
║  │  │ Account  │  │ Account  │  │ VPC      │              │ ║
║  │  │    1     │  │    2     │  │ Owner    │              │ ║
║  │  │          │  │          │  │          │              │ ║
║  │  │ EC2+ALB  │  │   EC2    │  │   RDS    │              │ ║
║  │  └──────────┘  └──────────┘  └──────────┘              │ ║
║  │       │              │              │                   │ ║
║  │       └──────────────┼──────────────┘                   │ ║
║  │              PUEDEN COMUNICARSE                         │ ║
║  │              (IPs privadas)                             │ ║
║  │                                                          │ ║
║  │  ⚠️ NO pueden ver/modificar/eliminar recursos de otros  │ ║
║  └─────────────────────────────────────────────────────────┘ ║
║                                                               ║
║  ✅ Evita necesidad de VPC Peering                           ║
║  ✅ Security Groups pueden referenciarse cross-account       ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝
```

**Reglas clave:**
- Cada cuenta es responsable de sus propios recursos
- No pueden ver, modificar ni eliminar recursos de otras cuentas
- Solo comparten la RED
- Se comunican por IPs privadas

### 4. Managed Prefix Lists

**¿Qué es?**
Un conjunto de bloques CIDR que facilita configurar Security Groups y Route Tables.

```
┌─────────────────────────────────────────────────────────────┐
│  MANAGED PREFIX LIST                                        │
│                                                             │
│  Account A crea Prefix List:                               │
│  ┌─────────────────────┐                                   │
│  │ CIDR 1: 10.0.0.0/16 │                                   │
│  │ CIDR 2: 172.16.0.0/12│  ← Red interna corporativa      │
│  │ CIDR 3: 192.168.0.0/16│                                 │
│  └──────────┬──────────┘                                   │
│             │                                               │
│             │ Comparte via RAM                              │
│             ▼                                               │
│  ┌────────────────────────────────────────┐                │
│  │  Account B - Security Group            │                │
│  │                                         │                │
│  │  Inbound Rule:                         │                │
│  │  SSH (22) desde: prefix-list-A         │                │
│  │                                         │                │
│  │  ✅ Si modificás el prefix list,        │                │
│  │     TODOS los SGs se actualizan        │                │
│  └────────────────────────────────────────┘                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**Dos tipos:**
| Tipo | Descripción |
|------|-------------|
| **Customer Managed** | Vos definís los CIDRs, podés compartir y modificar |
| **AWS Managed** | AWS define los CIDRs para sus servicios, NO podés modificar/compartir |

### 5. Route 53 Outbound Resolver (compartir reglas DNS)

Para setups híbridos con múltiples cuentas y VPCs:

```
┌──────────────┐                    ┌──────────────┐
│ Account      │   Comparte         │ Account      │
│ Principal    │   via RAM          │ Secundaria   │
│              │ ─────────────────► │              │
│ Forwarding   │                    │ Acepta y     │
│ Rules        │                    │ asocia a VPC │
│ (DNS)        │                    │              │
└──────────────┘                    └──────────────┘

→ Gestión CENTRALIZADA de reglas DNS
```

---

## Para el Examen

1. **RAM** = compartir recursos entre cuentas AWS
2. **Caso más importante** = compartir VPC Subnets
3. **NO se puede compartir** = Security Groups ni VPC default
4. **Compartir subnet** = evita VPC Peering, comunicación por IP privada
5. **Participantes NO ven** recursos de otras cuentas (solo la red)
6. **Prefix Lists** = gestión centralizada de CIDRs para Security Groups
7. **Subnets compartidas** = deben ser de la misma Organization

---

## Cuándo usar RAM vs otras soluciones

| Escenario | Solución |
|-----------|----------|
| Apps en diferentes cuentas que necesitan misma red | RAM (compartir subnet) |
| Conectar VPCs de diferentes cuentas | VPC Peering o Transit Gateway |
| Compartir configuración DNS en híbrido | RAM (Route 53 Resolver rules) |
| Gestión centralizada de CIDRs permitidos | RAM (Prefix Lists) |

---

*Siguiente: 3.11 Summary of Identity & Federation*
