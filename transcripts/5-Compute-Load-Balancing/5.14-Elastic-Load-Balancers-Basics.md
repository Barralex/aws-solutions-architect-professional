# 5.14 Elastic Load Balancers - Basics

**Curso:** AWS Solutions Architect Professional (SAP-C02)
**Sección:** 5 - Compute & Load Balancing
**Duración:** ~10 min

---

## Resumen

4 tipos de ELB: CLB (legacy), ALB (HTTP/Layer 7), NLB (TCP-UDP/Layer 4, ultra rápido), GWLB (Layer 3, para appliances de seguridad). ALB para apps web, NLB para performance extrema, GWLB para firewalls/IDS.

---

## Los 4 Load Balancers

| Tipo | Layer | Protocolos | Uso |
|------|-------|------------|-----|
| **CLB** (Classic) | 4/7 | HTTP, HTTPS, TCP, SSL | Legacy, no usar |
| **ALB** (Application) | 7 | HTTP, HTTPS, WebSocket | Apps web, microservicios |
| **NLB** (Network) | 4 | TCP, TLS, UDP | Performance extrema |
| **GWLB** (Gateway) | 3 | IP (GENEVE) | Firewalls, IDS/IPS |

---

## ALB (Application Load Balancer)

### Características
- Layer 7 (HTTP)
- Routing por path, headers, query strings
- Soporta HTTP/2 y WebSocket
- Dynamic port mapping (ideal para ECS)
- Múltiples SSL certificates (SNI)

### Target Groups
- EC2 instances (con ASG)
- ECS tasks
- Lambda functions
- IP addresses (private)

```
                    ┌─► /users → Target Group 1 (EC2)
ALB ────────────────┤
                    └─► /search → Target Group 2 (ECS)
```

---

## NLB (Network Load Balancer)

### Características
- Layer 4 (TCP/UDP)
- Millones de requests por segundo
- Latencia ~100ms (vs ~400ms ALB)
- **Static IP por AZ** (puede usar Elastic IP)
- No incluido en free tier

### Target Groups
- EC2 instances
- IP addresses
- **ALB** (NLB → ALB para tener static IP + features de Layer 7)

### Zonal DNS Name
```
Regional DNS: mi-nlb.elb.amazonaws.com
  → Devuelve IPs de TODAS las AZs

Zonal DNS: us-east-1a.mi-nlb.elb.amazonaws.com
  → Devuelve IP de UNA AZ específica
  → Útil para minimizar latencia y costos de data transfer
```

---

## GWLB (Gateway Load Balancer)

### Para qué sirve
- Firewalls
- Intrusion Detection (IDS)
- Intrusion Prevention (IPS)
- Deep packet inspection

### Cómo funciona
```
Usuario
   │
   ▼
Route Table ──► GWLB ──► Security Appliances (firewall, IDS)
                  │              │
                  │◄─────────────┘ (tráfico inspeccionado)
                  │
                  ▼
            Tu Aplicación
```

- Protocolo GENEVE en puerto 6081
- Todo el tráfico pasa por los appliances
- Target groups: EC2 o IPs privadas

---

## CLB vs ALB (SSL Certificates)

| CLB | ALB |
|-----|-----|
| 1 SSL certificate | Múltiples SSL (SNI) |
| Para más dominios: múltiples CLBs | Un ALB para todos |

---

## Puntos Clave Examen

1. **ALB** = Layer 7, HTTP, routing por path/headers
2. **NLB** = Layer 4, TCP/UDP, static IP, ultra rápido
3. **GWLB** = Layer 3, para firewalls/IDS, protocolo GENEVE
4. **NLB → ALB** = cuando querés static IP + features de ALB
5. **Zonal DNS** = para minimizar costos entre AZs
6. **SNI** = múltiples SSL certs en un ALB (CLB no tiene)

