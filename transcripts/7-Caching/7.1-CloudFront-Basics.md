# 7.1 CloudFront - Basics

## Qué es
- CDN (Content Delivery Network)
- 200+ edge locations globales
- Cachea contenido cerca del usuario
- Protección DDoS (Shield, WAF integrado)
- HTTPS automático

## Origins (de dónde viene el contenido)

| Origin | Uso |
|--------|-----|
| S3 bucket | Archivos estáticos (con OAC) |
| Media Services | Video on demand, streaming |
| VPC Origin | ALB/NLB/EC2 en subnets privadas ✅ (nuevo, mejor) |
| Custom HTTP | Cualquier endpoint público |

## OAC (Origin Access Control)

```
Usuario → CloudFront → (OAC) → S3 bucket

S3 bucket policy solo permite acceso desde CloudFront
Nadie puede ir directo al bucket
```

## CloudFront vs S3 Cross-Region Replication

| | CloudFront | S3 CRR |
|---|------------|--------|
| Scope | 200+ edge locations | Regiones específicas |
| Update | Cache con TTL | Near real-time |
| Uso | Contenido estático global | Contenido dinámico, pocas regiones |

## VPC Origin (manera nueva/mejor)

```
CloudFront → VPC Origin → Private ALB/NLB/EC2

Todo privado, sin exponer nada a internet
```

## Public ALB/EC2 (manera vieja)

```
CloudFront → Public ALB → Private EC2

Problema: ALB expuesto a internet
Solución: Custom HTTP Header secreto

CloudFront agrega: X-Secret-Header: abc123
ALB solo acepta requests con ese header
```

## Origin Groups (HA + Failover)

```
CloudFront
    │
    ├── Primary: S3 us-east-1
    │        │
    │        └── si falla...
    │
    └── Secondary: S3 eu-west-1 (replica)

Cross-region disaster recovery
```

## Para el examen

```
CDN + cache global           → CloudFront
S3 privado via CloudFront    → OAC
Private ALB/EC2 + CloudFront → VPC Origin
Failover cross-region        → Origin Groups
Proteger ALB público         → Custom HTTP Header secreto
```
