# 7.2 CloudFront - Advanced

## Geo Restriction

```
Allow List → Solo estos países pueden acceder
Block List → Estos países NO pueden acceder

Usa base de datos Geo-IP para determinar país
```

**Header automático:** `CloudFront-Viewer-Country`
- Lo recibe tu origin o Lambda@Edge
- Podés personalizar contenido por país

**Uso:** Copyright laws, restricciones legales

## Price Classes (Cost Optimization)

```
PRICE CLASS    REGIONES                      COSTO
───────────────────────────────────────────────────
All            Todas (200+)                  $$$
200            La mayoría (excluye caras)    $$
100            Solo las baratas              $
               (US, Canada, Europe)
```

Más barato: US, Mexico, Canada
Más caro: India, South America, Australia

## Signed URLs

Acceso controlado con expiración.

```
Cliente → App Server → "Dame acceso al video"
                │
                ▼
          Genera Signed URL (SDK)
                │
                ▼
Cliente → CloudFront (con signed URL) → S3
```

**Características:**
- Filtrar por IP, path, fecha
- Expiration
- Funciona con cualquier origin (no solo S3)
- Aprovecha cache del edge

## CloudFront Signed URL vs S3 Pre-signed URL

| | CloudFront Signed URL | S3 Pre-signed URL |
|---|----------------------|-------------------|
| Origin | Cualquiera | Solo S3 |
| Key | Account-wide key pair | IAM credentials |
| Cache | Sí, usa edge cache | No, directo a S3 |
| Uso | Contenido via CDN | Upload/download directo |

## Custom Error Pages

Cuando origin devuelve 4xx/5xx, mostrar página custom.

```
Request → CloudFront → Origin → 403 Forbidden
                         │
                         ▼
              Custom Error Page (S3)
                         │
                         ▼
              error-403.html → Cliente
              (se cachea en edge)
```

## Para el examen

```
Bloquear países              → Geo Restriction
Reducir costos CloudFront    → Price Class 100 o 200
Acceso temporal a contenido  → Signed URL
4xx/5xx con página bonita    → Custom Error Pages
Header con país del usuario  → CloudFront-Viewer-Country
```
