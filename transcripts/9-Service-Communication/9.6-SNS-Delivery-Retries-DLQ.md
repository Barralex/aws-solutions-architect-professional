# 9.6 SNS Message Delivery Retries & Dead Letter Queues

## Delivery Policy (AWS Managed Endpoints)

Para Lambda, SQS, Kinesis Firehose:

| Fase | Intentos | Delay |
|------|----------|-------|
| Immediate | 3 | Sin delay |
| Pre-backoff | 2 | 1 seg |
| Backoff | 10 | 1-20 seg (exponential) |
| Post-backoff | 100,000 | 20 seg |
| **Total** | **100,015** | **23 días** |

## Custom Delivery Policy (solo HTTP/HTTPS)

Solo endpoints HTTP/HTTPS soportan custom policy:
- Número de retries
- Min/Max delay
- Backoff function
- Throttle policy

## Dead Letter Queue (DLQ)

- Se adjunta a la **SUBSCRIPTION**, no al topic
- DLQ = SQS queue (o FIFO si SNS FIFO)
- Captura mensajes que agotan el delivery policy

```
SNS Topic
    │
    ├── Email Subscription ───▶ DLQ 1 (si falla)
    │
    └── HTTP Subscription ────▶ DLQ 2 (si falla)
```

## Para el examen

| Ves en pregunta | Respuesta |
|-----------------|-----------|
| Custom retry policy en SNS | Solo HTTP/HTTPS endpoints |
| DLQ en SNS se adjunta a... | Subscription (NO topic) |
| Mensajes no entregados en SNS | DLQ en la subscription |
