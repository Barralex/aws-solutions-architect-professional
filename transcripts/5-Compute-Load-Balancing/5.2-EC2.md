# 5.2 EC2

**Curso:** AWS Solutions Architect Professional (SAP-C02)
**Sección:** 5 - Compute & Load Balancing
**Duración:** ~10 min

---

## Resumen

EC2 deep dive: familias de instancias (R, C, M, I, G, T), placement groups (cluster, spread, partition), tipos de compra (on-demand, spot, reserved, dedicated), Graviton processors, métricas (RAM no incluida), instance recovery con CloudWatch.

---

## Familias de instancias

| Familia | Optimizado para | Caso de uso |
|---------|-----------------|-------------|
| **R** (R5, etc) | RAM | In-memory caches |
| **C** | CPU/Compute | Databases, computación |
| **M** | Medium/Balanced | Web apps generales |
| **I** | I/O (Instance Store) | High performance DBs |
| **G** | GPU | ML, video rendering |
| **T2/T3** | Burstable | Spikes de carga |

---

## Placement Groups

### Cluster
- Mismo rack, misma AZ
- 10 Gbps entre instancias
- Si rack falla, TODO falla
- Uso: HPC, Big Data jobs rápidos

### Spread
- Hardware diferente, puede ser multi-AZ
- Máximo 7 instancias por AZ
- Máxima separación = máxima disponibilidad
- Uso: Apps críticas

### Partition
- Múltiples particiones por AZ (hasta 7)
- Cientos de instancias
- Particiones no comparten racks
- Uso: Hadoop, Cassandra, Kafka

### Mover instancia a/desde placement group
1. Stop instance
2. CLI: modify instance placement
3. Start instance

---

## Tipos de compra

| Tipo | Duración | Descuento | Uso |
|------|----------|-----------|-----|
| **On-Demand** | Corta | 0% | Workloads predecibles |
| **Spot** | Corta | ~90% | Puede perderse, resiliente a fallas |
| **Reserved** | 1-3 años | Hasta 72% | Workloads largos conocidos |
| **Convertible Reserved** | 1-3 años | Menos | Cambiar tipo en el tiempo |
| **Dedicated Instance** | - | - | No compartir hardware |
| **Dedicated Host** | - | - | Licencias por core/socket |

Pago upfront = más descuento

---

## Graviton

- Procesadores ARM de AWS
- Mejor precio/performance
- **Solo Linux** (NO Windows)
- Graviton2: 40% mejor que x86
- Graviton3: 3x mejor que Graviton2

---

## Métricas EC2

| Métrica | Incluida |
|---------|----------|
| CPU | ✅ |
| Network In/Out | ✅ |
| Status Checks | ✅ |
| Disk (solo instance store) | ✅ |
| **RAM** | ❌ Custom metric |

---

## Instance Recovery

```
EC2 ──► CloudWatch Alarm ──► EC2 Instance Recovery
              │
              └──► SNS (notificación)
```

Conserva: Private IP, Public IP, Elastic IP, Metadata, Placement Group

---

## Puntos Clave Examen

1. **Cluster** = velocidad, riesgo de falla total
2. **Spread** = máx 7 por AZ, máxima disponibilidad
3. **Partition** = Hadoop/Kafka, cientos de instancias
4. **Graviton** = NO Windows
5. **RAM** = NO incluida en métricas, custom metric
6. **Instance Recovery** = CloudWatch alarm action

