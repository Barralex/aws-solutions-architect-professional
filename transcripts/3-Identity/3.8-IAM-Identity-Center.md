# 3.8 AWS IAM Identity Center

## Resumen
IAM Identity Center (antes llamado AWS SSO) proporciona Single Sign-On para todas las cuentas AWS de una organización, aplicaciones de negocio (Salesforce, Microsoft 365) e instancias EC2 Windows. Un login, acceso a todo.

---

## Conceptos Clave

### 1. ¿Qué es IAM Identity Center?

**Antes:** AWS Single Sign-On (SSO)
**Ahora:** AWS IAM Identity Center

**Permite:**
- SSO a todas las cuentas AWS en Organizations
- SSO a aplicaciones cloud (Salesforce, Box, M365) via SAML 2.0
- SSO a instancias EC2 Windows

```
┌─────────────────────────────────────────────────────────────┐
│              IAM IDENTITY CENTER                             │
│                                                             │
│  Un login → Acceso a:                                       │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │ AWS Account │  │ AWS Account │  │ AWS Account │        │
│  │    Dev      │  │    Prod     │  │   Shared    │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │ Salesforce  │  │ Microsoft   │  │    Box      │        │
│  │             │  │    365      │  │             │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│  ┌─────────────────────────────────────────────┐          │
│  │         EC2 Windows Instances               │          │
│  └─────────────────────────────────────────────┘          │
└─────────────────────────────────────────────────────────────┘
```

### 2. Identity Providers (dónde están los usuarios)

**Opción A: Built-in Identity Store**
- Usuarios y grupos definidos directamente en IAM Identity Center
- Como IAM pero centralizado para toda la org

**Opción B: External Identity Provider**
- Active Directory (on-premise o AWS Managed AD)
- Okta
- OneLogin
- Cualquier IdP compatible SAML 2.0

### 3. Permission Sets (el concepto clave)

Un Permission Set es una COLECCIÓN de políticas IAM que defines una vez y asignas a usuarios/grupos en cuentas específicas.

```
┌─────────────────────────────────────────────────────────────┐
│  EJEMPLO: Bob y Alice son developers                        │
│                                                             │
│  1. Crear grupo "Developers" (Bob, Alice)                  │
│                                                             │
│  2. Crear Permission Set "AdminAccess"                     │
│     → Asignar a Dev Account A, Dev Account B               │
│     → Asignar al grupo Developers                          │
│     → Bob y Alice = Admin en cuentas Dev                   │
│                                                             │
│  3. Crear Permission Set "ReadOnlyAccess"                  │
│     → Asignar a Prod Account A, Prod Account B             │
│     → Asignar al grupo Developers                          │
│     → Bob y Alice = ReadOnly en cuentas Prod               │
└─────────────────────────────────────────────────────────────┘
```

**Importante:** IAM Identity Center crea AUTOMÁTICAMENTE un IAM Role en cada cuenta con los permisos del Permission Set.

### 4. Attribute-Based Access Control (ABAC)

Permisos basados en atributos del usuario:
- Cost Center
- Título (Junior, Senior)
- Localidad (región)

**Beneficio:** Defines Permission Sets UNA vez, y cambias accesos solo modificando atributos del usuario.

---

## Flujo de Login

```
Usuario → Login en IAM Identity Center → Portal con todas sus cuentas/apps
                                              │
                                              ▼
                                    Click en "Dev Account"
                                              │
                                              ▼
                              AssumeRole automático al IAM Role
                              creado por el Permission Set
                                              │
                                              ▼
                                    Consola AWS con permisos
```

---

## Para el Examen

1. **IAM Identity Center** = antes se llamaba AWS SSO
2. **Se configura en la Management Account** de Organizations
3. **Permission Sets** = colección de políticas IAM asignadas a cuentas
4. **Crea IAM Roles automáticamente** en cada cuenta
5. **ABAC** = permisos basados en atributos del usuario
6. **Ideal para:** SSO en múltiples cuentas AWS (pregunta típica)

---

## Cuándo usar qué

| Escenario | Solución |
|-----------|----------|
| Login a múltiples cuentas AWS | IAM Identity Center |
| App mobile con login social | Cognito |
| Empleados con AD corporativo, una sola cuenta | SAML 2.0 Federation |
| Acceso programático temporal cross-account | STS AssumeRole |

---

*Siguiente: 3.9 AWS Control Tower*
